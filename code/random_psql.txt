ogr2ogr -f "PostgreSQL" PG:"dbname= forest_fires user=sallamander" "/Users/sallamander/galvanize/forest-fires/data/raw_data/MODIS/2014" -nlt PROMOTE_TO_MULTI -nln forest_fires -append

PGCLIENTENCODING=LATIN1 ogr2ogr -f "PostgreSQL" PG:"dbname= forest_fires user=sallamander" "/Users/sallamander/galvanize/forest-fires/data/boundary_files/county/2014" -nlt PROMOTE_TO_MULTI -nln county -append

CREATE TABLE forest_st_cnty AS
 (SELECT points.*, polys.countyfp, polys.statefp
 FROM forest_fires as points
		JOIN county as polys
 ON ST_WITHIN(points.wkb_geometry, polys.wkb_geometry)); 

CREATE UNIQUE INDEX perim_date ON daily_fire_shapefiles_2013 (date_, fire_name);


SELECT COUNT(fire_name) as total, fire_name, date_
FROM daily_fire_shapefiles_2013 
GROUP BY fire_name, date_
ORDER BY total DESC
LIMIT 50; 

CREATE TABLE merged_2013 AS
             (SELECT points.*, polys.wkb_geometry as geom2, polys.fire_name, polys.fire, polys.agency, polys.unit_id
             FROM detected_fires_2013 as points
                    LEFT JOIN daily_fire_shapefiles_2013 as polys
             ON points.date = polys.date_ 
                AND ST_WITHIN(points.wkb_geometry, polys.wkb_geometry));